# Configuración de ChromaDB para Project Brain

version: "1.0.0"
created_at: "{{TIMESTAMP}}"
system: "project_brain"

# --------------------------------------------------
# Configuración de persistencia
# --------------------------------------------------
persistence:
  persist_directory: "./data/embeddings/chroma"
  migration_mode: "auto"
  allow_reset: false

# --------------------------------------------------
# Configuración de colecciones
# --------------------------------------------------
collections:
  code_embeddings:
    name: "code_embeddings"
    metadata:
      description: "Embeddings de código fuente"
      embedding_model: "all-MiniLM-L6-v2"
      embedding_dimension: 384
      similarity_metric: "cosine"
      normalized: true
      created_at: "{{TIMESTAMP}}"
    index_settings:
      hnsw:
        M: 16
        ef_construction: 200
        ef_search: 50

  text_embeddings:
    name: "text_embeddings"
    metadata:
      description: "Embeddings de texto y documentación"
      embedding_model: "all-mpnet-base-v2"
      embedding_dimension: 768
      similarity_metric: "dotproduct"
      normalized: true
      created_at: "{{TIMESTAMP}}"
    index_settings:
      hnsw:
        M: 16
        ef_construction: 200
        ef_search: 50

  document_embeddings:
    name: "document_embeddings"
    metadata:
      description: "Embeddings de documentos completos"
      embedding_model: "all-MiniLM-L6-v2"
      embedding_dimension: 384
      similarity_metric: "cosine"
      normalized: true
      created_at: "{{TIMESTAMP}}"
    index_settings:
      hnsw:
        M: 16
        ef_construction: 200
        ef_search: 50

# --------------------------------------------------
# Configuración global de índices
# --------------------------------------------------
index:
  default_type: "hnsw"
  hnsw:
    space: "cosine"
    max_elements: 1000000
    ef_construction: 200
    M: 16
    allow_replace_deleted: true

# --------------------------------------------------
# Configuración de caché
# --------------------------------------------------
cache:
  enabled: true
  max_size_mb: 1024
  cleanup_interval_seconds: 3600

# --------------------------------------------------
# Configuración de rendimiento
# --------------------------------------------------
performance:
  batch_size: 100
  max_concurrent_searches: 10
  search_timeout_seconds: 30

# --------------------------------------------------
# Configuración de mantenimiento
# --------------------------------------------------
maintenance:
  auto_optimize: true
  optimize_interval_hours: 24
  vacuum_on_startup: true
  compaction_threshold: 0.7

# --------------------------------------------------
# Políticas de retención
# --------------------------------------------------
retention:
  max_collection_size: 1000000
  auto_prune: true
  prune_threshold_days: 365
  archive_old_data: true
  archive_path: "./data/embeddings/archive"

# --------------------------------------------------
# Seguridad
# --------------------------------------------------
security:
  encryption_at_rest: false   # Habilitar en producción
  encryption_key_path: null
  access_logging: true
  audit_trail: true

# --------------------------------------------------
# Métricas y monitoreo
# --------------------------------------------------
monitoring:
  collect_metrics: true
  metrics_port: 8002
  health_check_endpoint: "/health"
  prometheus_enabled: true
