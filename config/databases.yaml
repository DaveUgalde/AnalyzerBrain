# ============================================
# CONFIGURACIÓN DE BASES DE DATOS - OPTIMIZADA
# ============================================

databases:
  
  # PostgreSQL - Principal
  postgresql:
    enabled: true
    connection:
      host: "${POSTGRES_HOST:-localhost}"
      port: "${POSTGRES_PORT:-5432}"
      database: "${POSTGRES_DB:-project_brain}"
      username: "${POSTGRES_USER:-brain_user}"
      password: "${POSTGRES_PASSWORD}"
      ssl_mode: "${POSTGRES_SSL_MODE:-prefer}"
      connect_timeout: 30
    
    pool:
      size: "${POSTGRES_POOL_SIZE:-20}"
      max_overflow: "${POSTGRES_MAX_OVERFLOW:-10}"
      recycle_seconds: 3600
      pre_ping: true
    
    performance:
      statement_cache_size: 100
      echo: false
      isolation_level: "READ_COMMITTED"
  
  # Redis - Caché y Pub/Sub
  redis:
    enabled: true
    connection:
      host: "${REDIS_HOST:-localhost}"
      port: "${REDIS_PORT:-6379}"
      password: "${REDIS_PASSWORD}"
      db: 0
      ssl: "${REDIS_SSL:-false}"
    
    pool:
      max_connections: 100
      timeout: 5
    
    cache:
      default_ttl_seconds: 3600
      key_prefix: "brain:"
      compression: true
    
    pubsub:
      enabled: true
      channels:
        - system_events
        - analysis_updates
        - agent_messages
  
  # Neo4j - Grafo de Conocimiento
  neo4j:
    enabled: true
    connection:
      uri: "${NEO4J_URI:-bolt://localhost:7687}"
      username: "${NEO4J_USER:-neo4j}"
      password: "${NEO4J_PASSWORD}"
      database: "project_brain"
    
    performance:
      connection_lifetime: 3600
      pool_size: 50
      encrypted: false
    
    indexes:
      auto_create: true
      indexes_file: "./config/neo4j_indexes.cypher"
  
  # ChromaDB - Vector Store
  chroma:
    enabled: true
    settings:
      persist_directory: "${CHROMA_DIR:-./data/chroma}"
      anonymized_telemetry: false
      allow_reset: true
    
    collections:
      code_embeddings:
        name: "code_embeddings"
        metadata:
          hnsw_space: "cosine"
          description: "Embeddings de código"
      
      document_embeddings:
        name: "document_embeddings"
        metadata:
          hnsw_space: "cosine"
          description: "Embeddings de documentación"